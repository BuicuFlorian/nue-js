class Nue{constructor(t){this.root=document.querySelector(t.el),this.rawData=t.data,this.methods=t.methods,this.data=this.observe(this.rawData),this.registerMethods(),this.registerListeners(),this.refreshDom()}get directives(){return{"n-text":(t,e)=>{t.innerText=e},"n-show":(t,e)=>{t.style.display=e?"":"none"}}}observe(t){const e=this;return new Proxy(t,{set(t,s,r){t[s]=r,e.refreshDom()}})}registerMethods(){for(let t in this.methods)this[t]=this.methods[t]}registerListeners(){this.walkDom(this.root,t=>{Array.from(t.attributes).forEach(e=>{if(!e.name.startsWith("@"))return;const s=e.name.replace("@","");t.addEventListener(s,()=>{const t=e.value;this[t]?this[t]():evaluate(this.data,t)})})})}refreshDom(){this.walkDom(this.root,t=>{Array.from(t.attributes).forEach(e=>{if(!Object.keys(this.directives).includes(e.name))return;const s=evaluate(this.data,e.value);this.directives[e.name](t,s)})})}walkDom(t,e){for(e(t),t=t.firstElementChild;t;)this.walkDom(t,e),t=t.nextElementSibling}}function evaluate(data,value){return eval(`with (data) { (${value}) }`)}